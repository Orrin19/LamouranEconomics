<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">

<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
<link rel="stylesheet" href="styles.css">
<script type="text/javascript" src="countries.js"></script>
<script type="text/javascript" src="../goods.js"></script>
<title>Классовое деление Цуньжоу</title>  
<link rel = "icon" href = "../logo.png" type = "image/x-icon"> 
<script>
window.onload = function () {
var chart = new CanvasJS.Chart("chartContainer", {
	animationEnabled: true,
	exportEnabled: true,
	title:{
		text: "Классовое деление Цуньжоу"
	},
	data: [{
		type: "pyramid",
		indexLabelFontSize: 18,
		valueRepresents: "area",	
		indexLabel: "{indexLabel} - #percent%",
		toolTipContent: "<b>{indexLabel}:</b> {y} (#percent%)",
		dataPoints: [
			{ y: peasant, indexLabel: "Крестьяне"},
			{ y: worker, indexLabel: "Рабочие"},
			{ y: merchant, indexLabel: "Торговцы"},
			{ y: noble, indexLabel: "Аристократия"},
			{ y: priest, indexLabel: "Духовенство"}
		]
	}]
});
chart.render();
}
/* When the user clicks on the button,
toggle between hiding and showing the dropdown content */
function myFunction() {
  document.getElementById("myDropdown").classList.toggle("show");
}

// Close the dropdown menu if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
</script>
<style>
	td{
		border: 1px solid black;
	}
</style>
</head>
<header class="p-3 text-bg-dark">
	<div class="container">
	  <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
		<a href="/" class="d-flex align-items-center mb-2 mb-lg-0 text-white text-decoration-none">
		  <svg class="bi me-2" width="40" height="32" role="img" aria-label="Bootstrap"><use xlink:href="#bootstrap"></use></svg>
		</a>
		<ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
		  <li><a href="../index.html" class="nav-link px-2 text-secondary dropbtn">Домой</a></li>
		</ul>
	  </div>
	</div>
  </header>
<body>
<div class="container">
	
<p style="text-align:center ;">
	<img src="../flags/kr.png" width="250px">
</p>
<div id="chartContainer" style="height: 370px; max-width: 920px; margin: 0px auto;"></div>
<table class="center" style="border: 1px solid black;">
	<colgroup>
		<col class="grey" />
		<col class="green"/>
		<col class="blue" />
		<col class="blue" />
	  </colgroup>
	<tr>
		<td>
			Население
		</td>
		<td>
			<p id="pep" style="display: inline;"></p>K
		</td>
		<td>
			<p id="male" style="display: inline;"></p> тыс. муж
		</td>
		<td>
			<p id="female" style="display: inline;"></p> тыс. жен
		</td>
	</tr>
	<tr>
		<td>
			Уровнь урбанизации
		</td>
		<td>
			<p id="urb" style="display: inline;"></p>%
		</td>
		<td>
			<p id="urbpep" style="display: inline;"></p> тыс. горожан
		</td>
		<td>
			<p id="rurpep" style="display: inline;"></p> тыс. селчан
		</td>
	</tr>
	<tr>
		<td>
			Эффективность госаппарата (Max 80%)
		</td>
		<td>
			<p id="gos" style="display: inline;"></p>%
		</td>
		<td>
			Ползунок &darr;
		</td>
		<td>
			Налогая ставка &darr;
		</td>
	</tr>
	<tr>
		<td>
			Налоги с бедного населения
		</td>
		<td>
			<p id="poor" style="display: inline;"></p>K$
		</td>
		<td>
			<input type="range" min="10" max="50" step="1" id="ptf" oninput="poorTaxFix()" value="10"></p>
		</td>
		<td>
			<p id="poorTaxPercent"style="display: inline;"></p>%
		</td>
	</tr>
	<tr>
		<td>
			Налоги со среднего класса
		</td>
		<td>
			<p id="middle" style="display: inline;"></p>K$
		</td>
		<td>
			<input type="range" min="10" max="50" step="1" id="mtf" oninput="middleTaxFix()" value="10"></p>
		</td>
		<td>
			<p id="middleTaxPercent"style="display: inline;"></p>%
		</td>
	</tr>
	
	<tr>
		<td>
			Налоги с богатого класса
		</td>
		<td>
			<p id="rich" style="display: inline;"></p>K$
		</td>
		<td>
			<input type="range" min="10" max="50" step="1" id="rtf" oninput="richTaxFix()" value="10"></p>
		</td>
		<td>
			<p id="richTaxPercent"style="display: inline;"></p> %
		</td>
	</tr>
	<tr>
		<td>
			Доходы от производства
		</td>
		<td>
			<p id="production" style="display: inline;"></p>K$
		</td>
	</tr>
	<tr>
		<td>
			Контроль (автономия)
		</td>
		<td>
			<p id="control" style="display: inline;"></p>
		</td>
		<td>
			При 100% контроле
		</td>
		<td>
			<p id="controlFull" style="display: inline;"></p>K$
		</td>
	</tr>
	<tr>
		<td>
			Итоговый доход
		</td>
		<td>
			<p id="profit" style="display: inline;"></p>K$
		</td>
	</tr>
</table>
</div>
<script>
	var rural = Tsunzhou.Rural;
	var urban = Tsunzhou.Urban;
	var control = Tsunzhou.Control;
	var production = Tsunzhou.BladedWeapon * Produced.BladedWeapon
	+ Tsunzhou.Polearms * Produced.Polearms
	+ Tsunzhou.RangedWeapons * Produced.RangedWeapons
	+ Tsunzhou.CheapClothes * Produced.CheapClothes
	+ Tsunzhou.ExpensiveClothes * Produced.ExpensiveClothes
	+ Tsunzhou.Jewelry * Produced.Jewelry
	+ Tsunzhou.Beer * Produced.Beer
	+ Tsunzhou.Wine * Produced.Wine
	+ Tsunzhou.WritingMaterials * Produced.WritingMaterials
	+ Tsunzhou.Pottery * Produced.Pottery
	+ Tsunzhou.ShipTackle * Produced.ShipTackle
	+ Tsunzhou.FinishedWood * Produced.FinishedWood
	+ Tsunzhou.Steel * Produced.FinishedWood
	+ Tsunzhou.HeavyArmor * Produced.HeavyArmor
	+ Tsunzhou.MediumArmor * Produced.MediumArmor
	+ Tsunzhou.LightArmor * Produced.LightArmor;
	var all = rural + urban;
	var noble = all * 0.051;
	var priest = all * 0.011;
	var merchant = rural * 0.01 + urban * 0.15;
	var peasant = rural * 0.84;
	var worker = urban * 0.71 + rural * 0.1;
	var urb = Math.floor(urban/(all)*10000)/100;
	var gos = Math.floor(((noble+merchant)/3)/all*urb*10000)/100;
	var poorTax = Math.floor(peasant/100)/100;
	var middleTax = Math.floor((worker+merchant)/100)/100;
	var richTax = Math.floor((priest+noble)/100)/100;
	document.getElementById("pep").innerHTML = Math.floor((all)/1000);
	document.getElementById("gos").innerHTML = gos;
	document.getElementById("urb").innerHTML = urb;
	document.getElementById("control").innerHTML = control;
	document.getElementById("production").innerHTML = production/10000;
	document.getElementById("urbpep").innerHTML = Math.floor(urban/10)/100;
	document.getElementById("rurpep").innerHTML = Math.floor(rural/10)/100;
	document.getElementById("male").innerHTML = Math.floor(all*0.52/10)/100;
	document.getElementById("female").innerHTML = Math.floor(all*0.48/10)/100;
	var p = document.getElementById("poor");
	var pt = document.getElementById("poorTaxPercent");
	var m = document.getElementById("middle");
	var mt = document.getElementById("middleTaxPercent");
	var r = document.getElementById("rich");
	var rt = document.getElementById("richTaxPercent");
	var prod = document.getElementById("production");
	var finalProfit = document.getElementById("profit");
	var ctlFull = document.getElementById("controlFull");
	p.innerHTML= poorTax*1.1;
	m.innerHTML = middleTax*1.1;
	r.innerHTML = richTax*1.1;
	pt.innerHTML = 10;
	mt.innerHTML = 10;
	rt.innerHTML = 10;
	var ptf = document.getElementById("ptf");
	var finalTax = (poorTax+middleTax+richTax)*1.1
	ctlFull.innerHTML = finalTax+Math.floor(production)/12000;
	finalProfit.innerHTML = Math.floor(((finalTax+Math.floor(production)/12000)*control)*100)/100;
	var poorTaxFinal = poorTax, middleTaxFinal = middleTax, richTaxFinal=richTax;
	function finalProf()
	{
		var final = poorTaxFinal+middleTaxFinal+richTaxFinal+Math.floor(production)/12000;
		ctlFull.innerHTML =  Math.floor((final)*100)/100;
		final*=control;
		finalProfit.innerHTML = Math.floor((final)*100)/100;
	}
	function poorTaxFix() 
	{
	var val = ptf.value;
	pt.innerHTML = val;
	var end = poorTax + poorTax*val/100;
	poorTaxFinal = end;
	p.innerHTML = Math.floor(end*100)/100;
	finalProf();
	}
	function middleTaxFix() 
	{
	var val = mtf.value;
	mt.innerHTML = val;
	var end = middleTax + middleTax*val/100;
	middleTaxFinal = end;
	m.innerHTML = Math.floor(end*100)/100;
	finalProf();
	}
	function richTaxFix() 
	{
	var val = rtf.value;
	rt.innerHTML = val;
	var end = richTax + richTax*val/100;
	richTaxFinal = end;
	r.innerHTML = Math.floor(end*100)/100;
	finalProf();
	}
</script>
<script src="canvasjs.min.js"></script>
<footer class="py-3 my-4">
	<ul class="nav justify-content-center border-bottom pb-3 mb-3">
	  <li class="nav-item"><a href="../index.html" class="nav-link px-2 text-muted">Домой</a></li>
	  <li class="nav-item"><a href="https://lamoraun.fandom.com/ru/wiki" class="nav-link px-2 text-muted">Вики</a></li>
	  <li class="nav-item"><a href="https://discordserver.info/664491015914258452/invite" class="nav-link px-2 text-muted">Дискорд</a></li>
	</ul>
	<p class="text-center text-muted">© 2022 РВПИ Ламоран</p>
  </footer>
</body>
</html>