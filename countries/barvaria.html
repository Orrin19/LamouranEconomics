<!DOCTYPE HTML>
<html>

<head>
	<meta charset="UTF-8">

	<!-- CSS only -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
	<link rel="stylesheet" href="/src/styles.css">
	<title>Классовое деление Барварии</title>
	<link rel="icon" href="/src/logo.png" type="image/x-icon">
	<script>
		window.onload = function () {
			var chart = new CanvasJS.Chart("chartContainer", {
				animationEnabled: true,
				exportEnabled: true,
				title: {
					text: document.title
				},
				data: [{
					type: "pyramid",
					indexLabelFontSize: 18,
					valueRepresents: "area",
					indexLabel: "{indexLabel} - #percent%",
					toolTipContent: "<b>{indexLabel}:</b> {y} (#percent%)",
					dataPoints: [
						{ y: peasant, indexLabel: "Крестьяне" },
						{ y: worker, indexLabel: "Рабочие" },
						{ y: merchant, indexLabel: "Торговцы" },
						{ y: noble, indexLabel: "Аристократия" },
						{ y: priest, indexLabel: "Духовенство" }
					]
				}]
			});
			chart.render();
		}
	</script>
</head>

<body>
	<script type="text/javascript" src="/src/generate-header.js"></script>
	<script type="text/javascript" src="/src/dropdown.js"></script>

	<script type="text/javascript" src="/src/countries.js"></script>
	<div class="container">
		<p style="text-align:center ;">
			<img src="/flags/de.png" width="250px">
		</p>
		<div id="chartContainer" style="height: 370px; max-width: 920px; margin: 0px auto;"></div>
		<table class="center" style="border: 1px solid black;">
			<tr>
				<td>
					Население
				</td>
				<td>
					<p id="pep" style="display: inline;"></p>K
				</td>
				<td>
					<p id="male" style="display: inline;"></p> тыс. муж
				</td>
				<td>
					<p id="female" style="display: inline;"></p> тыс. жен
				</td>
			</tr>
			<tr>
				<td>
					Уровнь урбанизации
				</td>
				<td>
					<p id="urb" style="display: inline;"></p>%
				</td>
				<td>
					<p id="urbpep" style="display: inline;"></p> тыс. горожан
				</td>
				<td>
					<p id="rurpep" style="display: inline;"></p> тыс. селчан
				</td>
			</tr>
			<tr>
				<td>
					Эффективность госаппарата (Max 80%)
				</td>
				<td>
					<p id="gos" style="display: inline;"></p>%
				</td>
				<td>
					Ползунок &darr;
				</td>
				<td>
					Налогая ставка &darr;
				</td>
			</tr>
			<tr>
				<td>
					Налоги с бедного населения
				</td>
				<td>
					<p id="poor" style="display: inline;"></p>K$
				</td>
				<td>
					<input type="range" min="10" max="50" step="1" id="ptf" oninput="poorTaxFix()" value="10"></p>
				</td>
				<td>
					<p id="poorTaxPercent" style="display: inline;"></p>%
				</td>
			</tr>
			<tr>
				<td>
					Налоги со среднего класса
				</td>
				<td>
					<p id="middle" style="display: inline;"></p>K$
				</td>
				<td>
					<input type="range" min="10" max="50" step="1" id="mtf" oninput="middleTaxFix()" value="10"></p>
				</td>
				<td>
					<p id="middleTaxPercent" style="display: inline;"></p>%
				</td>
			</tr>

			<tr>
				<td>
					Налоги с богатого класса
				</td>
				<td>
					<p id="rich" style="display: inline;"></p>K$
				</td>
				<td>
					<input type="range" min="10" max="50" step="1" id="rtf" oninput="richTaxFix()" value="10"></p>
				</td>
				<td>
					<p id="richTaxPercent" style="display: inline;"></p> %
				</td>
			</tr>
		</table>
	</div>
	<script>
		var rural = Countries.barvaria.rural;
		var urban = Countries.barvaria.urban;
		var all = rural + urban;
		var noble = all * 0.051;
		var priest = all * 0.011;
		var merchant = rural * 0.01 + urban * 0.15;
		var peasant = rural * 0.84;
		var worker = urban * 0.71 + rural * 0.1;
		var urb = Math.floor(urban / (all) * 10000) / 100;
		var gos = Math.floor(((noble + merchant) / 3) / all * urb * 10000) / 100;
		var poorTax = Math.floor(peasant / 100) / 100;
		var middleTax = Math.floor((worker + merchant) / 100) / 100;
		var richTax = Math.floor((priest + noble) / 100) / 100;
		document.getElementById("pep").innerHTML = Math.floor((all) / 1000);
		document.getElementById("gos").innerHTML = gos;
		document.getElementById("urb").innerHTML = urb;
		document.getElementById("urbpep").innerHTML = Math.floor(urban / 10) / 100;
		document.getElementById("rurpep").innerHTML = Math.floor(rural / 10) / 100;
		document.getElementById("male").innerHTML = Math.floor(all * 0.52 / 10) / 100;
		document.getElementById("female").innerHTML = Math.floor(all * 0.48 / 10) / 100;;
		var p = document.getElementById("poor");
		var pt = document.getElementById("poorTaxPercent");
		var m = document.getElementById("middle");
		var mt = document.getElementById("middleTaxPercent");
		var r = document.getElementById("rich");
		var rt = document.getElementById("richTaxPercent");
		p.innerHTML = poorTax * 1.1;
		m.innerHTML = middleTax * 1.1;
		r.innerHTML = richTax * 1.1;
		pt.innerHTML = 10;
		mt.innerHTML = 10;
		rt.innerHTML = 10;
		var ptf = document.getElementById("ptf");
		function poorTaxFix() {
			var val = ptf.value;
			pt.innerHTML = val;
			var end = poorTax + poorTax * val / 100;
			p.innerHTML = Math.floor(end * 100) / 100;
		}
		function middleTaxFix() {
			var val = mtf.value;
			mt.innerHTML = val;
			var end = middleTax + middleTax * val / 100;
			m.innerHTML = Math.floor(end * 100) / 100;
		}
		function richTaxFix() {
			var val = rtf.value;
			rt.innerHTML = val;
			var end = richTax + richTax * val / 100;
			r.innerHTML = Math.floor(end * 100) / 100;
		}
	</script>
	<script type="text/javascript" src="/src/canvasjs.min.js"></script>

	<script type="text/javascript" src="/src/generate-footer.js"></script>
</body>

</html>