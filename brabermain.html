<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">

<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
<link rel="stylesheet" href="styles.css">
<script type="text/javascript" src="countries.js"></script>
<title>Классовое деление Брабермейн</title>  
<script>
window.onload = function () {
var chart = new CanvasJS.Chart("chartContainer", {
	animationEnabled: true,
	exportEnabled: true,
	title:{
		text: "Классовое деление Брабермейн"
	},
	data: [{
		type: "pyramid",
		indexLabelFontSize: 18,
		valueRepresents: "area",	
		indexLabel: "{indexLabel} - #percent%",
		toolTipContent: "<b>{indexLabel}:</b> {y} (#percent%)",
		dataPoints: [
			{ y: peasant, indexLabel: "Крестьяне"},
			{ y: worker, indexLabel: "Рабочие"},
			{ y: merchant, indexLabel: "Торговцы"},
			{ y: noble, indexLabel: "Аристократия"},
			{ y: priest, indexLabel: "Духовенство"}
		]
	}]
});
chart.render();
}
/* When the user clicks on the button,
toggle between hiding and showing the dropdown content */
function myFunction() {
  document.getElementById("myDropdown").classList.toggle("show");
}

// Close the dropdown menu if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
</script>
<style>
	td{
		border: 1px solid black;
	}
</style>
</head>
<header class="p-3 text-bg-dark">
	<div class="container">
	  <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
		<a href="/" class="d-flex align-items-center mb-2 mb-lg-0 text-white text-decoration-none">
		  <svg class="bi me-2" width="40" height="32" role="img" aria-label="Bootstrap"><use xlink:href="#bootstrap"></use></svg>
		</a>
		<ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
		  <li><a href="index.html" class="nav-link px-2 text-secondary dropbtn">Домой</a></li>
		</ul>
	  </div>
	</div>
  </header>
<body>
<div class="container">
<div id="chartContainer" style="height: 370px; max-width: 920px; margin: 0px auto;"></div>
<table style="margin-left:22%; border: 1px solid black;">
	<tr>
		<td>
			Население
		</td>
		<td>
			<p id="pep" style="display: inline;"></p>K
		</td>
		<td>
			<p id="male" style="display: inline;"></p> тыс. муж
		</td>
		<td>
			<p id="female" style="display: inline;"></p> тыс. жен
		</td>
	</tr>
	<tr>
		<td>
			Уровнь урбанизации
		</td>
		<td>
			<p id="urb" style="display: inline;"></p>%
		</td>
		<td>
			<p id="urbpep" style="display: inline;"></p> тыс. горожан
		</td>
		<td>
			<p id="rurpep" style="display: inline;"></p> тыс. селчан
		</td>
	</tr>
	<tr>
		<td>
			Эффективность госаппарата (Max 80%)
		</td>
		<td>
			<p id="gos" style="display: inline;"></p>%
		</td>
		<td>
			Ползунок &darr;
		</td>
		<td>
			Налогая ставка &darr;
		</td>
	</tr>
	<tr>
		<td>
			Налоги с бедного населения
		</td>
		<td>
			<p id="poor" style="display: inline;"></p>K$
		</td>
		<td>
			<input type="range" min="10" max="50" step="1" id="ptf" oninput="poorTaxFix()" value="10"></p>
		</td>
		<td>
			<p id="poorTaxPercent"style="display: inline;"></p>%
		</td>
	</tr>
	<tr>
		<td>
			Налоги со среднего класса
		</td>
		<td>
			<p id="middle" style="display: inline;"></p>K$
		</td>
		<td>
			<input type="range" min="10" max="50" step="1" id="mtf" oninput="middleTaxFix()" value="10"></p>
		</td>
		<td>
			<p id="middleTaxPercent"style="display: inline;"></p>%
		</td>
	</tr>
	
	<tr>
		<td>
			Налоги с богатого класса
		</td>
		<td>
			<p id="rich" style="display: inline;"></p>K$
		</td>
		<td>
			<input type="range" min="10" max="50" step="1" id="rtf" oninput="richTaxFix()" value="10"></p>
		</td>
		<td>
			<p id="richTaxPercent"style="display: inline;"></p> %
		</td>
	</tr>
</table>
</div>
<script>
	var rural = Brabermain.Rural;
	var urban = Brabermain.Urban;
	var all = rural + urban;
	var noble = all * 0.051;
	var priest = all * 0.011;
	var merchant = rural * 0.01 + urban * 0.15;
	var peasant = rural * 0.84;
	var worker = urban * 0.71 + rural * 0.1;
	var urb = Math.floor(urban/(all)*10000)/100;
	var gos = Math.floor(((noble+merchant)/3)/all*urb*10000)/100;
	var poorTax = Math.floor(peasant/100)/100;
	var middleTax = Math.floor((worker+merchant)/100)/100;
	var richTax = Math.floor((priest+noble)/100)/100;
	document.getElementById("pep").innerHTML = Math.floor((all)/1000);
	document.getElementById("gos").innerHTML = gos;
	document.getElementById("urb").innerHTML = urb;
	document.getElementById("urbpep").innerHTML = Math.floor(urban/10)/100;
	document.getElementById("rurpep").innerHTML = Math.floor(rural/10)/100;
	document.getElementById("male").innerHTML = Math.floor(all*0.52/10)/100;
	document.getElementById("female").innerHTML = Math.floor(all*0.48/10)/100;;
	var p = document.getElementById("poor");
	var pt = document.getElementById("poorTaxPercent");
	var m = document.getElementById("middle");
	var mt = document.getElementById("middleTaxPercent");
	var r = document.getElementById("rich");
	var rt = document.getElementById("richTaxPercent");
	p.innerHTML= poorTax*1.1;
	m.innerHTML = middleTax*1.1;
	r.innerHTML = richTax*1.1;
	pt.innerHTML = 10;
	mt.innerHTML = 10;
	rt.innerHTML = 10;
	var ptf = document.getElementById("ptf");
	function poorTaxFix() 
	{
	var val = ptf.value;
	pt.innerHTML = val;
	var end = poorTax + poorTax*val/100;
	p.innerHTML = Math.floor(end*100)/100;
	}
	function middleTaxFix() 
	{
	var val = mtf.value;
	mt.innerHTML = val;
	var end = middleTax + middleTax*val/100;
	m.innerHTML = Math.floor(end*100)/100;
	}
	function richTaxFix() 
	{
	var val = rtf.value;
	rt.innerHTML = val;
	var end = richTax + richTax*val/100;
	r.innerHTML = Math.floor(end*100)/100;
	}
</script>
<script src="canvasjs.min.js"></script>
</body>
</html>